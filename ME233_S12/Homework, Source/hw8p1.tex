\item
A discrete-time plant is given by
\begin{align}
\label{rep-pro-plant}
    A(q^{-1}) y(k) = q^{-\textrm{d}} \, B(q^{-1}) \left \{ u(k) + d(k) \right \}
\end{align}
where $A(q^{-1}) = (1 - 0.8 q^{-1})(1 - 0.7 q^{-1})$, $\textrm{d} = 1 $ and $B(q^{-1}) = 0.1$. Here, $u(k)$ is the control input, $y(k)$ is the output, and $d(k)$ represent the disturbance.  The disturbance is known to be periodic and the period is $N = 8$ (i.e. $d(k+8) = d(k)$).

\begin{enumerate}
    \item
    Use the fact that $A_d(q^{-1})\,d(k) = 0$, where $A_d(q^{-1}) = 1-q^{-8}$
    and design the
    %repetitive
    regulator of the form
    \begin{align*}
        u(k) = - \frac{S(q^{-1})}{A_d(q^{-1})\, R^{'}(q^{-1})}\, y(k)
    \end{align*}
    which drives $y(k)$ to zero in finite time. (i.e.\ the closed-loop polynomial should be $A_c(q^{-1}) = 1$. Find the polynomials  $R^{'}(q^{-1})$ and $S(q^{-1})$ as the solution of the Diophantine equation
    \begin{align*}
        A_c(q^{-1}) = A_d(q^{-1}) \, A(q^{-1}) \, R^{'}(q^{-1}) + q^{-\textrm{d}} \, B(q^{-1}) \,S(q^{-1}) \,.
    \end{align*}

    \item
    \label{part:rep_simulation}
    Simulate the control system designed above when the periodic disturbance is given by
    \begin{align*}
        (d(0),d(1),\ldots,d(7)) = (0,\, 1.5,\, 3,\, 0,\, -2,\, -2,\, 0,\, 0.5)
    \end{align*}
    %{$d(0)=0,\;d(1)=1.5,\;d(2)=3,\;d(3)=0,\;d(4)=-2,\;d(5)=-2,\;d(6)=0, \; d(7)=0.5$
    and $d(k+8) = d(k)$.  Assume that the plant initial condition is zero.

    \item
    Now consider a repetitive controller of the form
    \begin{align*}
        u(k) = - \frac{k_r q^{-(N-\textrm{d})} A(q^{-1})}{A_d(q^{-1})\, B(q^{-1})}\, y(k) \; .
    \end{align*}
    Simulate this repetitive controller under the same conditions described in problem \ref{part:rep_simulation}. Try values of 0.5, 1 and 1.3 for $k_r$.

    \item
    Assume now that the plant model form is still described by \eqref{rep-pro-plant}, but
    the plant dynamics are now given by
    \begin{align*}
        A(q^{-1}) & = (1 - 0.2 q^{-1}) \, \bar{A}(q^{-1}) \\
        \bar{A}(q^{-1}) & = (1 - 0.8 q^{-1})(1 - 0.7 q^{-1}) \\
        B(q^{-1}) & = 0.08 \\
        \textrm{d} & = 2.
    \end{align*}
    Moreover, we use the repetitive controller from the previous part, which is given by
    \begin{align*}
        u(k) = - \frac{k_r q^{-(N-1)} \bar{A}(q^{-1})}{0.1\,A_d(q^{-1}) }\, y(k)\,.
    \end{align*}

    In other words, the real plant is
    \begin{align*}
        G_{_A}(q) = \frac{0.1 q^{-1}}{(1 - 0.8 q^{-1})(1 - 0.7 q^{-1}) }\, \frac{0.8 q^{-1}}{(1 - 0.2 q^{-1})}
    \end{align*}
    but we use the simplified plant
    \begin{align*}
        G(q) = \frac{0.1 q^{-1} }{(1 - 0.8 q^{-1})(1 - 0.7 q^{-1})}
    \end{align*}
    in the control system design process.

    Show, using the root locus technique, that the resulting repetitive control system is unstable for any positive $k_r$.

    \item
    Assume again that the plant model form is still described by \eqref{rep-pro-plant}, but
    the plant dynamics are now given by
    \begin{align*}
        A(q^{-1}) & = (1 - 0.2 q^{-1}) \, \bar{A}(q^{-1}) \\
        \bar{A}(q^{-1}) & = (1 - 0.8 q^{-1})(1 - 0.7 q^{-1}) \\
        B(q^{-1}) & = 0.08 \\
        \textrm{d} = 2.
    \end{align*}
    (These are the same dynamics considered in the previous part.) However, we now incorporate the Q-filter modification to the repetitive compensator, in order to make the repetitive controller more robust. Thus,
    \begin{align*}
        u(k) = - \frac{k_r q^{-(N-1)} \bar{A}(q^{-1})}{ 0.1\, (1 - Q(q,q^{-1})q^{-N})}\, y(k)\,.
    \end{align*}
    where
    \begin{align*}
        Q(q,q^{-1}) = \frac{q + 2 + q^{-1}}{4}\,.
    \end{align*}
    Do the following:
    \begin{enumerate}
        \item
        Plot the root locus of the closed-loop poles of the resulting repetitive control system for $k_r \geq 0$ and determine,  a value of $k_r$ for which  the resulting repetitive control system is asymptotically stable.

        \item
        Simulate this repetitive controller under the same conditions described in problem \ref{part:rep_simulation}.
    \end{enumerate}
\end{enumerate}
